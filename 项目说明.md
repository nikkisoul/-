# 供应链物料时间差距分析工具 - 项目说明

## 📁 项目结构

```
物料时间差距分析工具/
│
├── app.py                    # 主应用程序文件（Streamlit应用）
├── requirements.txt          # Python依赖库清单
│
├── 启动程序.bat              # 一键启动脚本（推荐使用）
├── 安装依赖.bat              # 手动安装依赖脚本
├── 测试安装.bat              # 测试依赖是否安装成功
│
├── README.md                 # 项目说明文档（英文）
├── 使用说明.txt              # 详细使用说明（中文）
├── 项目说明.md               # 本文件
│
└── data/                     # 数据文件夹
    ├── 采购计划模板.csv      # 采购计划数据模板
    └── 到货数据模板.csv      # 到货数据模板
```

## 🚀 快速开始指南

### 第一步：安装依赖

**方式一：自动安装（推荐）**
1. 双击 `启动程序.bat`
2. 首次运行会自动安装所有依赖库
3. 等待安装完成后，程序会自动启动

**方式二：手动安装**
1. 双击 `安装依赖.bat`
2. 等待所有依赖库安装完成
3. 然后双击 `启动程序.bat` 启动应用

**方式三：命令行安装**
```bash
cd 物料时间差距分析工具
python -m pip install -r requirements.txt
```

### 第二步：启动应用

双击 `启动程序.bat`，应用会自动在浏览器中打开。

如果没有自动打开，请手动访问：http://localhost:8501

### 第三步：开始使用

1. 点击侧边栏的"加载示例数据"按钮，查看演示
2. 或者前往【数据管理】页面上传您自己的数据
3. 在各个分析页面查看结果

## 📊 核心功能说明

### 1. 首页概览
- 显示关键指标摘要
- 快速查看整体数据情况
- 提供示例数据加载功能

### 2. 数据管理
- **数据上传**：支持Excel和CSV文件批量导入
- **手动输入**：逐条添加采购计划和到货记录
- **架次管理**：维护物料有效起始架次信息

### 3. 时间差距分析
- 自动计算需求时间与到货时间的天数差距
- 提供多维度筛选（供应商、物料类型等）
- 展示统计摘要和可视化图表
  - 条形图：各物料平均时间差距
  - 分布图：时间差距分布情况
  - 趋势图：时间差距随时间变化

### 4. 架次分析
- 选择特定架次查看详细情况
- 架次完成率仪表盘
- 各物料需求与到货对比
- 完成率分布图

### 5. 报告导出
- 生成CSV格式的分析报告
- 包含所有计算结果和统计数据

## 📋 数据格式要求

### 采购计划数据

| 字段名 | 类型 | 必填 | 说明 | 示例 |
|--------|------|------|------|------|
| 计划编号 | 文本 | 是 | 采购计划唯一标识 | P001 |
| 物料编号 | 文本 | 是 | 物料唯一标识 | M001 |
| 物料名称 | 文本 | 是 | 物料名称 | 螺栓A |
| 物料类型 | 文本 | 是 | 物料分类 | 紧固件 |
| 供应商 | 文本 | 是 | 供应商名称 | 供应商A |
| 架次 | 文本 | 是 | 生产架次编号 | 001 |
| 需求数量 | 数字 | 是 | 需要的数量 | 1000 |
| 需求日期 | 日期 | 是 | 期望到货日期 | 2024-02-01 |

### 到货数据

| 字段名 | 类型 | 必填 | 说明 | 示例 |
|--------|------|------|------|------|
| 到货编号 | 文本 | 是 | 到货记录唯一标识 | D001 |
| 物料编号 | 文本 | 是 | 物料唯一标识 | M001 |
| 架次 | 文本 | 是 | 生产架次编号 | 001 |
| 已到货数量 | 数字 | 是 | 实际到货数量 | 1000 |
| 实际到货日期 | 日期 | 是 | 实际到货日期 | 2024-02-05 |

**日期格式**：YYYY-MM-DD（如：2024-02-01）

## 🔑 关键指标解释

### 时间差距（天）
- **计算公式**：实际到货日期 - 需求日期
- **正值**：延迟到货（如 +5 表示延迟5天）
- **负值**：提前到货（如 -3 表示提前3天）
- **零值**：准时到货

### 按时到货率
- **计算公式**：(按时或提前到货的物料数 ÷ 总物料数) × 100%
- **说明**：时间差距 ≤ 0 的物料被视为按时到货

### 架次完成率
- **计算公式**：(已到货数量 ÷ 需求数量) × 100%
- **说明**：某架次所有物料的到货完成情况

## 🛠️ 故障排除

### 问题1：程序无法启动
**解决方案**：
1. 确认已安装Python 3.8或更高版本
2. 运行 `测试安装.bat` 检查依赖是否安装成功
3. 如果依赖未安装，运行 `安装依赖.bat`

### 问题2：数据上传失败
**解决方案**：
1. 检查文件格式是否为CSV或Excel
2. 确认文件包含所有必需字段
3. 检查日期格式是否正确（YYYY-MM-DD）
4. 参考data文件夹中的模板文件

### 问题3：图表显示异常
**解决方案**：
1. 刷新浏览器页面
2. 检查数据是否完整
3. 确认日期字段没有缺失值

### 问题4：如何清空数据
**解决方案**：
- 直接刷新浏览器页面即可清空所有数据

## 💡 使用技巧

1. **首次使用**：建议先加载示例数据，熟悉各项功能
2. **数据准备**：参考模板文件准备数据，确保格式正确
3. **批量导入**：大量数据建议使用Excel/CSV文件导入
4. **筛选分析**：善用筛选功能，聚焦特定供应商或物料类型
5. **定期导出**：定期导出分析报告，保存历史数据

## 📞 技术支持

如遇到问题或有改进建议，请联系技术支持团队。

## 📝 更新日志

### v1.0 (2024-12)
- ✅ 初始版本发布
- ✅ 实现核心数据管理功能
- ✅ 实现时间差距分析
- ✅ 实现架次分析
- ✅ 实现数据可视化
- ✅ 实现报告导出

## 📄 许可证

© 2024 供应链物料时间差距分析工具

---

**祝您使用愉快！**
