# 供应链物料时间差距分析工具

## 📋 简介

这是一个基于Streamlit开发的供应链数据分析工具，用于分析物料需求时间与实际到货时间之间的差距，帮助优化供应链管理流程。

## ✨ 核心功能

- ✅ **数据管理**：支持上传Excel/CSV文件或手动输入物料需求和到货数据
- ✅ **架次管理**：支持手动输入和维护物料有效起始架次信息
- ✅ **时间差距分析**：自动计算并可视化需求时间与到货时间之间的天数差距
- ✅ **架次完成率分析**：根据多维度数据计算各架次物料配套完成情况
- ✅ **多维度筛选**：支持按供应商、物料类型等维度进行分析筛选
- ✅ **数据可视化**：提供丰富的图表展示，包括趋势图、分布图、仪表盘等
- ✅ **报告导出**：支持将分析结果导出为CSV格式

## 📊 数据维度

应用可以处理和分析以下数据：

1. **采购计划下达数据**
2. **合同签订数据**
3. **订单签收数据**
4. **已到货物料数据**
5. **待检区物料数据**
6. **库存数据**
7. **已交付物料数据**
8. **已退返物料数据**

## 🚀 快速开始

### 方法一：双击运行（推荐）

1. 确保您的电脑已安装Python 3.8或更高版本
   - 如果没有安装，请访问 https://www.python.org/downloads/ 下载安装
   
2. 双击 `启动程序.bat` 文件
   - 首次运行会自动安装所需的依赖库
   - 程序会自动在浏览器中打开

3. 开始使用！

### 方法二：命令行运行

1. 打开命令提示符（CMD）或PowerShell

2. 进入项目目录：
   ```bash
   cd 物料时间差距分析工具
   ```

3. 安装依赖（首次运行）：
   ```bash
   pip install -r requirements.txt
   ```

4. 启动应用：
   ```bash
   streamlit run app.py
   ```

5. 在浏览器中访问 http://localhost:8501

## 📖 使用指南

### 1. 数据管理

#### 上传数据
- 进入【数据管理】页面
- 选择【数据上传】标签
- 上传Excel或CSV格式的采购计划和到货数据文件

#### 手动输入
- 选择【手动输入】标签
- 填写表单添加采购计划或到货记录

#### 架次管理
- 选择【架次管理】标签
- 输入物料编号和有效起始架次信息
- 系统会根据架次信息进行物料分析

### 2. 时间差距分析

- 进入【时间差距分析】页面
- 使用筛选条件选择要分析的数据范围
- 查看统计摘要和可视化图表
- 分析物料到货的延迟或提前情况

### 3. 架次分析

- 进入【架次分析】页面
- 选择要分析的架次
- 查看该架次的物料完成率仪表盘
- 分析各物料的需求与到货对比情况

### 4. 报告导出

- 进入【报告导出】页面
- 选择导出类型
- 点击生成并下载报告
- 获得CSV格式的分析报告

## 📁 数据格式说明

### 采购计划数据格式

| 列名 | 说明 | 示例 |
|------|------|------|
| 计划编号 | 采购计划的唯一标识 | P001 |
| 物料编号 | 物料的唯一标识 | M001 |
| 物料名称 | 物料的名称 | 螺栓A |
| 物料类型 | 物料的分类 | 紧固件 |
| 供应商 | 供应商名称 | 供应商A |
| 架次 | 生产架次编号 | 001 |
| 需求数量 | 需要的物料数量 | 1000 |
| 需求日期 | 期望到货的日期 | 2024-02-01 |

### 到货数据格式

| 列名 | 说明 | 示例 |
|------|------|------|
| 到货编号 | 到货记录的唯一标识 | D001 |
| 物料编号 | 物料的唯一标识 | M001 |
| 架次 | 生产架次编号 | 001 |
| 已到货数量 | 实际到货的数量 | 1000 |
| 实际到货日期 | 实际到货的日期 | 2024-02-05 |

## 🎯 关键指标说明

- **平均时间差距**：所有物料需求日期与实际到货日期差距的平均值（单位：天）
  - 正值表示延迟到货
  - 负值表示提前到货
  
- **按时到货率**：在需求日期或之前到货的物料占比

- **架次完成率**：某架次已到货物料数量占需求数量的百分比

- **最大延迟**：所有物料中延迟到货天数最多的记录

## 🛠️ 技术栈

- **Python 3.8+**
- **Streamlit**：Web应用框架
- **Pandas**：数据处理
- **Plotly**：数据可视化
- **NumPy**：数值计算

## ❓ 常见问题

### Q: 程序无法启动怎么办？
A: 请确保已安装Python 3.8或更高版本，并检查是否有防火墙或杀毒软件阻止程序运行。

### Q: 如何导入大量数据？
A: 建议使用Excel或CSV文件批量导入，支持一次性导入多条记录。

### Q: 时间差距如何计算？
A: 时间差距 = 实际到货日期 - 需求日期，以天为单位。

### Q: 可以同时分析多个架次吗？
A: 可以，在时间差距分析页面可以查看所有架次的汇总数据，在架次分析页面可以逐个查看每个架次的详细情况。

## 📞 技术支持

如有问题或建议，请联系技术支持团队。

## 📄 版本信息

- **版本**：v1.0
- **更新日期**：2024年12月
- **开发者**：供应链分析团队

---

© 2024 供应链物料时间差距分析工具
