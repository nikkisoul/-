========================================
供应链物料时间差距分析工具 - 使用说明
========================================

一、快速启动
----------------------------------------
1. 双击桌面上的"启动程序.bat"文件
2. 等待程序自动安装依赖（首次运行需要几分钟）
3. 程序会自动在浏览器中打开
4. 如果没有自动打开，请手动访问：http://localhost:8501

二、主要功能
----------------------------------------
1. 【首页概览】
   - 查看关键指标摘要
   - 快速了解整体情况
   - 加载示例数据进行测试

2. 【数据管理】
   - 上传Excel/CSV文件批量导入数据
   - 手动输入采购计划和到货记录
   - 管理物料有效起始架次信息

3. 【时间差距分析】
   - 查看需求时间与到货时间的天数差距
   - 按供应商、物料类型等维度筛选
   - 查看统计摘要和可视化图表

4. 【架次分析】
   - 选择特定架次查看完成情况
   - 查看架次完成率仪表盘
   - 分析各物料的需求与到货对比

5. 【报告导出】
   - 生成分析报告
   - 导出CSV格式数据

三、数据格式要求
----------------------------------------
【采购计划数据】
必需字段：
- 计划编号
- 物料编号
- 物料名称
- 物料类型
- 供应商
- 架次
- 需求数量
- 需求日期（格式：YYYY-MM-DD，如2024-02-01）

【到货数据】
必需字段：
- 到货编号
- 物料编号
- 架次
- 已到货数量
- 实际到货日期（格式：YYYY-MM-DD，如2024-02-05）

四、使用示例
----------------------------------------
1. 首次使用建议：
   - 点击侧边栏的"加载示例数据"按钮
   - 查看各个页面的功能演示
   - 了解数据格式和分析方式

2. 导入自己的数据：
   - 参考data文件夹中的模板文件
   - 准备好Excel或CSV格式的数据
   - 在【数据管理】页面上传文件

3. 分析数据：
   - 在【时间差距分析】页面查看整体情况
   - 使用筛选条件聚焦特定数据
   - 在【架次分析】页面逐个分析各架次

五、关键指标说明
----------------------------------------
- 平均时间差距：所有物料到货时间与需求时间差距的平均值
  * 正值 = 延迟到货
  * 负值 = 提前到货
  * 0 = 准时到货

- 按时到货率：在需求日期或之前到货的物料占比

- 架次完成率：某架次已到货数量 ÷ 需求数量 × 100%

六、常见问题
----------------------------------------
Q: 如何停止程序？
A: 在命令行窗口按Ctrl+C，或直接关闭窗口

Q: 数据上传失败怎么办？
A: 检查文件格式是否正确，确保包含所有必需字段

Q: 如何清空数据重新开始？
A: 刷新浏览器页面即可清空所有数据

Q: 可以保存分析结果吗？
A: 可以在【报告导出】页面下载CSV格式的分析报告

七、技术要求
----------------------------------------
- 操作系统：Windows 7/10/11
- Python版本：3.8或更高
- 浏览器：Chrome、Edge、Firefox等现代浏览器
- 网络：首次运行需要联网下载依赖包

八、联系支持
----------------------------------------
如遇到问题或有改进建议，请联系技术支持团队。

========================================
祝您使用愉快！
========================================
